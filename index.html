<!doctype html>
<html lang="cs">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Výkaz práce</title>
  <link rel="stylesheet" href="style.css"/>

  <!-- knihovny -->
  <script src="https://cdn.jsdelivr.net/npm/dayjs@1/dayjs.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/exceljs@4.4.0/dist/exceljs.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2.45.4/dist/umd/supabase.min.js"></script>
</head>
<body>
  <header class="topbar">
  <h1 aria-hidden="true">&nbsp;</h1>
  <div id="userBoxTopRight" class="userbox"></div>
  </header>

<!-- AUTH PANEL (email + heslo) -->
<div id="authPanel" style="display:none; max-width:420px; margin:48px auto; padding:20px 22px; border:1px solid #e8eef7; border-radius:12px; background:#fff;">
  <h2 style="margin:0 0 12px; text-align:center;">Přihlášení</h2>
  <div style="display:grid; gap:10px;">
    <input id="authEmail" type="email" placeholder="E-mail" style="height:44px; border:1px solid #dfe7f3; border-radius:10px; padding:0 12px;">
    <input id="authPassword" type="password" placeholder="Heslo" style="height:44px; border:1px solid #dfe7f3; border-radius:10px; padding:0 12px;">
    <button id="authSignIn" style="height:44px; border-radius:10px; border:0; background:#0b1625; color:#fff; font-weight:700;">Přihlásit</button>
    <button id="authSignUp" style="height:44px; border-radius:10px; border:1px solid #dfe7f3; background:#fff;">Vytvořit účet</button>
  </div>
  <p id="authMsg" style="margin:10px 0 0; color:#c00; text-align:center; display:none;"></p>
</div>
  
  <main id="app" class="wrap">
   <!-- týden (export se vyvolá klikem na pill) -->
<section class="weekbar">
  <div class="weeknav">
    <button id="prevWeek" class="navbtn" title="Předchozí týden">◀</button>
    <div id="weekRange" class="weekpill" title="Klikni pro export do Excelu">–</div>
    <button id="nextWeek" class="navbtn" title="Další týden">▶</button>
  </div>
</section>

    <!-- filtry -->
    <section class="filters">
      <div class="filters-row">
        <label class="lbl">Nastavení filtru:</label>

        <select id="filterClient" class="pill-select"></select>
        <select id="filterStatus" class="pill-select"></select>

        <select id="totalsScope" class="pill-select">
          <option value="ME">Součty: Já</option>
          <option value="ALL">Součty: Všichni</option>
        </select>

        <!-- filtr „Grafik“ s ukotveným menu -->
        <div class="menuAnchor">
          <button id="assigneeFilterBtn" class="pill-btn">Grafik: Všichni</button>
          <div id="assigneeFilterMenu" class="menu" hidden>
            <label><input type="checkbox" value="Viki"> Viki</label>
            <label><input type="checkbox" value="Standa"> Standa</label>
            <label><input type="checkbox" value="Marek"> Marek</label>
            <div class="menuRow">
              <button id="assigneeFilterClear" class="pill-btn small" type="button">Vymazat</button>
              <button id="assigneeFilterClose" class="pill-btn small" type="button">Zavřít</button>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- přidání klienta/zakázky -->
    <section class="addRow">
      <div class="add-grid">
        <input id="newClientName" class="pill-input" placeholder="Název klienta"/>
        <button id="addClientBtn" class="pill-btn">Přidat klienta</button>

        <select id="newJobClient" class="pill-select"></select>
        <input id="newJobName" class="pill-input" placeholder="Název zakázky"/>
        <select id="newJobStatus" class="pill-select"></select>

        <div class="menuAnchor">
          <button id="assigneesNewBtn" class="pill-btn">Grafik: nikdo</button>
          <div id="assigneesNewMenu" class="menu" hidden>
            <label><input type="checkbox" value="Viki"> Viki</label>
            <label><input type="checkbox" value="Standa"> Standa</label>
            <label><input type="checkbox" value="Marek"> Marek</label>
            <div class="menuRow">
              <button id="assigneesNewClear" class="pill-btn small" type="button">Vymazat</button>
              <button id="assigneesNewClose" class="pill-btn small" type="button">Zavřít</button>
            </div>
          </div>
        </div>

        <button id="addJobBtn" class="pill-btn accent">Přidat zakázku</button>
      </div>
    </section>

    <!-- tabulka -->
    <section class="tableWrap">
      <table class="grid">
        <thead>
          <tr class="headpill">
            <th>Klient</th>
            <th>Zakázka</th>
            <th>Po</th><th>Út</th><th>St</th><th>Čt</th><th>Pá</th>
            <th>Celkem</th>
          </tr>
        </thead>
        <tbody id="tbody"></tbody>
        <tfoot>
          <tr id="sumRow">
            <td colspan="2" class="sumLabel">Součet za den</td>
            <td class="sumCell"></td>
            <td class="sumCell"></td>
            <td class="sumCell"></td>
            <td class="sumCell"></td>
            <td class="sumCell"></td>
            <td></td>
          </tr>
        </tfoot>
      </table>
    </section>
  </main>

  <div id="err" class="toast" style="display:none"></div>

  <script src="app.js"></script>
  <script src="auth.js"></script>
</body>
</html>
