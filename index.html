<!doctype html>
<html lang="cs">
<head>
  <meta charset="utf-8" />
  <meta
    name="viewport"
    content="width=device-width,initial-scale=1,maximum-scale=1"
  />
  <title>Výkaz práce</title>
  <link rel="stylesheet" href="style.css" />

  <!-- Supabase JS v2 -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2.45.4/dist/umd/supabase.js" defer></script>
  <!-- SheetJS pro Excel -->
  <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js" defer></script>
</head>
<body>
  <header class="app-header">
    <h1>Výkaz práce</h1>
    <div class="week-bar">
      <button id="prevWeek" class="arrow" aria-label="Předchozí týden">‹</button>
      <div id="weekLabel" class="week-label"></div>
      <button id="nextWeek" class="arrow" aria-label="Následující týden">›</button>
    </div>
    <div class="user-bar">
      <span id="userEmail" class="pill muted"></span>
      <button id="logoutBtn" class="pill">Odhlásit</button>
      <button id="exportBtn" class="pill outline">Export do Excelu</button>
    </div>
  </header>

  <main>
    <section class="filters">
      <div class="filters-title">Nastavení filtru:</div>

      <div class="pill-select">
        <select id="fltClients">
          <option value="all">Všichni klienti</option>
        </select>
        <span class="chev">▾</span>
      </div>

      <div class="pill-select">
        <select id="fltJobs">
          <option value="all">Všechny zakázky</option>
          <option value="new">Nové</option>
          <option value="open">Probíhá</option>
          <option value="done">Hotovo</option>
        </select>
        <span class="chev">▾</span>
      </div>

      <div class="pill-select">
        <select id="fltTotals">
          <option value="mine">Součty: Já</option>
          <option value="all">Součty: Všichni</option>
        </select>
        <span class="chev">▾</span>
      </div>

      <div class="pill-select">
        <select id="fltAssignee">
          <option value="all">Grafik: Všichni</option>
          <option value="none">Grafik: nikdo</option>
          <option value="Viki">Viki</option>
          <option value="Standa">Standa</option>
          <option value="Marek">Marek</option>
        </select>
        <span class="chev">▾</span>
      </div>
    </section>

    <section class="add-bar">
      <input id="newClientName" type="text" class="pill-input" placeholder="Název klienta" />
      <button id="addClientBtn" class="pill outline">Přidat klienta</button>

      <div class="pill-select">
        <select id="newJobClient">
          <option value="">— vyber klienta —</option>
        </select>
        <span class="chev">▾</span>
      </div>

      <input id="newJobName" type="text" class="pill-input grow" placeholder="Název zakázky" />

      <div class="pill-select">
        <select id="newJobStatus">
          <option value="new">Nová</option>
          <option value="open" selected>Nová</option>
          <option value="open">Probíhá</option>
          <option value="done">Hotovo</option>
        </select>
        <span class="chev">▾</span>
      </div>

      <div class="pill-select">
        <select id="newJobAssignees" multiple>
          <option value="Viki">Viki</option>
          <option value="Standa">Standa</option>
          <option value="Marek">Marek</option>
        </select>
        <span class="chev">▾</span>
      </div>

      <!-- Aby bylo zarovnání k „Celkem“, držíme button absolutně vpravo v rámci #tableWrap -->
      <button id="addJobBtn" class="pill solid">Přidat zakázku</button>
    </section>

    <section id="tableWrap">
      <table class="grid">
        <thead>
          <tr>
            <th class="th-left">Klient</th>
            <th class="th-left">Zakázka</th>
            <th>Po</th>
            <th>Út</th>
            <th>St</th>
            <th>Čt</th>
            <th>Pá</th>
            <th class="th-right">Celkem</th>
          </tr>
        </thead>
        <tbody id="tableBody"></tbody>
        <tfoot>
          <tr id="weekTotalsRow">
            <td colspan="2" class="tfoot-label">Součet za den</td>
            <td class="tfoot-chip" data-day="0">0</td>
            <td class="tfoot-chip" data-day="1">0</td>
            <td class="tfoot-chip" data-day="2">0</td>
            <td class="tfoot-chip" data-day="3">0</td>
            <td class="tfoot-chip" data-day="4">0</td>
            <td></td>
          </tr>
        </tfoot>
      </table>
    </section>
  </main>

  <!-- Popover pro výběr grafiků (při inline editaci) -->
  <div id="assigneePopover" class="assignee-popover hidden">
    <div class="assignee-list">
      <label><input type="checkbox" value="Viki" /> Viki</label>
      <label><input type="checkbox" value="Standa" /> Standa</label>
      <label><input type="checkbox" value="Marek" /> Marek</label>
    </div>
    <div class="assignee-actions">
      <button id="assigneesClear" class="pill outline">Vymazat</button>
      <button id="assigneesClose" class="pill">Zavřít</button>
    </div>
  </div>

  <script src="app.js" defer></script>
</body>
</html>
