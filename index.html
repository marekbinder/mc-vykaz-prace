<!doctype html>
<html lang="cs">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Výkaz práce</title>
  <link rel="stylesheet" href="style.css"/>
  <link rel="stylesheet" href="drawer.css">

  <!-- knihovny -->
  <script src="https://cdn.jsdelivr.net/npm/dayjs@1/dayjs.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/exceljs@4.4.0/dist/exceljs.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
</head>
<body>
  <header class="topbar">
    <h1>Výkaz práce</h1>
    <div id="userBoxTopRight" class="userbox"></div>
  </header>

  <main id="app" class="wrap">
    <!-- týden + export -->
    <section class="weekbar">
      <div class="weeknav">
        <button id="prevWeek" class="navbtn" title="Předchozí týden">◀</button>
        <div id="weekRange" class="weekpill">–</div>
        <button id="nextWeek" class="navbtn" title="Další týden">▶</button>
      </div>
      <button id="exportXlsx" class="pill-btn export">Export do Excelu</button>
    </section>

    <!-- filtry -->
    <section class="filters">
      <div class="filters-row">
        <label class="lbl">Nastavení filtru:</label>

        <select id="filterClient" class="pill-select"></select>
        <select id="filterStatus" class="pill-select"></select>

        <select id="totalsScope" class="pill-select">
          <option value="ME">Součty: Já</option>
          <option value="ALL">Součty: Všichni</option>
        </select>

        <!-- filtr „Grafik“ s ukotveným menu -->
        <div class="menuAnchor">
          <button id="assigneeFilterBtn" class="pill-btn">Grafik: Všichni</button>
          <div id="assigneeFilterMenu" class="menu" hidden>
            <label><input type="checkbox" value="Viki"> Viki</label>
            <label><input type="checkbox" value="Standa"> Standa</label>
            <label><input type="checkbox" value="Marek"> Marek</label>
            <div class="menuRow">
              <button id="assigneeFilterClear" class="pill-btn small" type="button">Vymazat</button>
              <button id="assigneeFilterClose" class="pill-btn small" type="button">Zavřít</button>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- přidání klienta/zakázky -->
    <section class="addRow">
      <div class="add-grid">
        <input id="newClientName" class="pill-input" placeholder="Název klienta"/>
        <button id="addClientBtn" class="pill-btn">Přidat klienta</button>

        <select id="newJobClient" class="pill-select"></select>
        <input id="newJobName" class="pill-input" placeholder="Název zakázky"/>
        <select id="newJobStatus" class="pill-select"></select>

        <div class="menuAnchor">
          <button id="assigneesNewBtn" class="pill-btn">Grafik: nikdo</button>
          <div id="assigneesNewMenu" class="menu" hidden>
            <label><input type="checkbox" value="Viki"> Viki</label>
            <label><input type="checkbox" value="Standa"> Standa</label>
            <label><input type="checkbox" value="Marek"> Marek</label>
            <div class="menuRow">
              <button id="assigneesNewClear" class="pill-btn small" type="button">Vymazat</button>
              <button id="assigneesNewClose" class="pill-btn small" type="button">Zavřít</button>
            </div>
          </div>
        </div>

        <button id="addJobBtn" class="pill-btn accent">Přidat zakázku</button>
      </div>
    </section>

    <!-- tabulka -->
    <section class="tableWrap">
      <table class="grid">
        <thead>
          <tr class="headpill">
            <th>Klient</th>
            <th>Zakázka</th>
            <th>Po</th><th>Út</th><th>St</th><th>Čt</th><th>Pá</th>
            <th>Celkem</th>
          </tr>
        </thead>
        <tbody id="tbody"></tbody>
        <tfoot>
          <tr id="sumRow">
            <td colspan="2" class="sumLabel">Součet za den</td>
            <td class="sumCell"></td>
            <td class="sumCell"></td>
            <td class="sumCell"></td>
            <td class="sumCell"></td>
            <td class="sumCell"></td>
            <td></td>
          </tr>
        </tfoot>
      </table>
    </section>
  </main>

  <div id="err" class="toast" style="display:none"></div>

  <script src="app.js"></script>

<!-- Drawer CSS/JS -->
<script src="drawer.js"></script>

<!-- Fallback markup (drawer.js si ho umí vytvořit i sám) -->
<div id="drawerBackdrop" class="backdrop" hidden></div>
<aside id="utilityDrawer" class="drawer" aria-hidden="true" tabindex="-1">
  <header class="drawer-head">
    <strong>Další nastavení</strong>
    <button id="utilClose" class="icon-btn" aria-label="Zavřít">✕</button>
  </header>

  <section class="drawer-sec">
    <h4>Přidat klienta</h4>
    <div id="drawerAddClient"></div>
  </section>

  <hr class="drawer-sep">

  <section class="drawer-sec">
    <h4>Účet</h4>
    <div class="drawer-account">
      <span id="drawerUser" class="userChip"></span>
      <button id="drawerLogout" class="pill-btn ghost" type="button">Odhlásit</button>
    </div>
  </section>
</aside>
  
</body>
</html>
